{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "Scaffold Next.js project with TypeScript and App Router",
        "description": "Scaffold new Next.js project with TypeScript, strict mode, and App Router. Set up project structure with domain-based folders. Install required dependencies: React Query, Zustand, chart library (Recharts), code editor (Monaco), date handling, form validation (React Hook Form + Zod). Configure Tailwind CSS for styling.",
        "details": "Run `npx create-next-app@latest frontend --typescript --tailwind --eslint --app --src-dir` or similar. Set up environment files (.env.local.example with NEXT_PUBLIC_API_BASE_URL). Create folder structure: src/app (App Router pages), src/components (UI components), src/hooks (custom hooks), src/lib (utilities, api client), src/types (TypeScript types), src/stores (Zustand stores). Key dependencies: @tanstack/react-query, zustand, recharts, @monaco-editor/react, react-hook-form + @hookform/resolvers + zod, date-fns, axios. Configure next.config.js for standalone output mode.",
        "testStrategy": "Verify project builds successfully with `npm run build`. Check TypeScript strict mode passes without errors. Verify all routes are accessible.",
        "priority": "high",
        "dependencies": [],
        "status": "completed",
        "subtasks": [
          {
            "id": 1,
            "title": "Scaffold Next.js project with create-next-app",
            "description": "Run npx create-next-app@latest to scaffold a new Next.js project with TypeScript, Tailwind CSS, ESLint, and App Router in the 'frontend' directory. Configure initial setup including removing demo pages and creating .env.local.example.",
            "dependencies": [],
            "details": "Execute: npx create-next-app@latest frontend --typescript --tailwind --eslint --app --src-dir --no-import-alias. Verify the project structure includes src/app, src/components, src/hooks, src/lib, src/types, src/stores folders. Check that next.config.js has strict mode enabled. Create .env.local.example with NEXT_PUBLIC_API_BASE_URL variable. Remove any default Next.js demo pages and styles.",
            "status": "completed",
            "testStrategy": "Run 'npm run build' to verify project compiles without TypeScript errors. Verify strict mode is enabled by checking tsconfig.json. Test that 'npm run dev' starts successfully.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Install dependencies and create API client with TypeScript types",
            "description": "Install all required frontend dependencies including React Query, Zustand, Recharts, Monaco Editor, React Hook Form with Zod, date-fns, and axios. Create API client and TypeScript type definitions mirroring backend Pydantic models.",
            "dependencies": [
              1
            ],
            "details": "Run: npm install @tanstack/react-query zustand recharts @monaco-editor/react react-hook-form @hookform/resolvers zod date-fns axios. Create src/lib/api/client.ts with axios instance configured with base URL from NEXT_PUBLIC_API_BASE_URL env var, interceptors for request/response, and error handling. Create src/types/api.ts with TypeScript interfaces mirroring backend Pydantic models: BacktestRequest, BacktestParams, ContributionFrequency (enum), ContributionPlan, FeeSettings, LLMSettings, GeneratedCode, ModelInfo, JobStatus (enum), ExecuteBacktestRequest/Response, BacktestResultResponse, EquityChartResponse, DrawdownChartResponse, MonthlyReturnsResponse.",
            "status": "completed",
            "testStrategy": "Verify all packages install without errors. Run TypeScript compilation to ensure types are correct. Test API client initialization with mock base URL.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Configure Next.js for production deployment",
            "description": "Configure Next.js for production deployment with standalone output mode, TypeScript path aliases, and environment variable validation for Docker compatibility.",
            "dependencies": [
              1
            ],
            "details": "Edit next.config.js to add output: 'standalone' and experimental features. Create or update tsconfig.json paths for @/lib, @/components, @/hooks, @/types, @/stores aliases pointing to src directory. Configure next.config.js with proper headers for API calls, image optimization settings, and react strict mode. Set up proper environment variable schema validation using zod for required env vars.",
            "status": "completed",
            "testStrategy": "Run 'npm run build' to verify standalone output is generated correctly. Check that the output/.next/standalone directory contains the necessary files. Verify path aliases work in imports.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Create folder structure for domain-based architecture",
            "description": "Create folder structure following domain-based architecture with proper barrel exports for clean imports across the application.",
            "dependencies": [
              1
            ],
            "details": "Create directory structure: src/app, src/components/ui, src/components/backtest, src/hooks, src/lib/api, src/lib/utils, src/types, src/stores. Add index.ts barrel files for each directory. Create src/app/page.tsx as main landing page. Set up src/app/layout.tsx with proper metadata and basic structure. Create sample components to verify folder structure works correctly.",
            "status": "completed",
            "testStrategy": "Verify all directories exist and contain index files. Test that imports using @/ alias work correctly. Run TypeScript compilation to verify no path resolution errors.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Configure npm scripts and environment files",
            "description": "Set up development and production scripts in package.json, verify .gitignore patterns, and create local environment configuration files.",
            "dependencies": [
              1
            ],
            "details": "Update package.json with scripts: 'dev' (next dev), 'build' (next build), 'start' (next start), 'lint' (next lint), 'type-check' (tsc --noEmit). Verify .gitignore has proper patterns for Next.js projects. Create .env.local with NEXT_PUBLIC_API_BASE_URL=http://localhost:8000/api/v1 for local development. Test that all npm scripts run without errors.",
            "status": "completed",
            "testStrategy": "Run each npm script to verify they work: npm run dev, npm run build, npm run lint. Verify .gitignore patterns are correct by checking git status. Confirm environment files are properly excluded.",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": 2,
        "title": "Build typed API client layer and DTOs",
        "description": "Create typed API client layer that mirrors backend Pydantic models. Generate TypeScript interfaces for all API request/response types aligned with backend models. Implement API client with axios wrapper with proper error handling.",
        "details": "Create src/types/api.ts with interfaces matching backend models: BacktestRequest, BacktestParams, ContributionFrequency (enum), ContributionPlan, FeeSettings, LLMSettings, GeneratedCode, ModelInfo, JobStatus (enum), ExecuteBacktestRequest/Response, BacktestResultResponse, EquityChartResponse, DrawdownChartResponse, MonthlyReturnsResponse. Create src/lib/api/client.ts with base URL from env var, axios instance with interceptors, and functions: generateCode(), executeBacktest(), getJobStatus(), getJobResult(), getFormattedResult().",
        "testStrategy": "Write unit tests for API client request/response mapping. Test error handling for 400/404/500 responses. Mock API responses for validation.",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "completed",
        "subtasks": [
          {
            "id": 1,
            "title": "Set up test environment with vitest",
            "description": "Set up test environment with vitest, @testing-library/react, jest-environment-jsdom, and msw. Configure vitest.config.ts with jsdom environment, path aliases, and test scripts in package.json.",
            "dependencies": [],
            "details": "Run npm install --save-dev vitest @testing-library/react @testing-library/jest-dom jest-environment-jsdom msw @types/msw. Create frontend/vitest.config.ts with test environment: 'jsdom', aliases for @/* paths, globals: true. Add test scripts to package.json: test, test:run, test:coverage. Create tests/setup.ts for test environment.",
            "status": "completed",
            "testStrategy": "Run npm run test to verify vitest works. Check test discovery works.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Align frontend DTOs with backend Pydantic models",
            "description": "Review and align frontend TypeScript interfaces with backend Pydantic models. Fix field name mismatches and add missing fields to ensure consistency.",
            "dependencies": [],
            "details": "Update src/types/api.ts: 1) Rename ModelInfo.model_name to model_id. 2) Rename GeneratedCode.detected_tickers to tickers. 3) Add missing LLMSettings fields: provider, model, seed. 4) Add CANCELLED and TIMEOUT to JobStatus enum. 5) Ensure all types are exported from src/types/index.ts. Run type-check.",
            "status": "completed",
            "testStrategy": "Run npm run type-check to verify TypeScript compiles.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Create unit tests for API types",
            "description": "Create unit tests for API types in tests/unit/api-types.test.ts. Test enum values, interface shapes, and type structures for all DTOs.",
            "dependencies": [
              1
            ],
            "details": "Create tests/unit/api-types.test.ts: 1) Test ContributionFrequency enum values. 2) Test JobStatus enum values. 3) Test BacktestRequest has strategy and params. 4) Test BacktestParams structure. 5) Test GeneratedCode shape. 6) Test BacktestResultResponse fields.",
            "status": "completed",
            "testStrategy": "Run npm run test to execute tests.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Create unit tests for API client with msw",
            "description": "Create unit tests for API client functions in tests/unit/api-client.test.ts using msw to mock HTTP requests and responses.",
            "dependencies": [
              1
            ],
            "details": "Create tests/unit/api-client.test.ts: 1) Set up msw http server. 2) Create handlers for all API endpoints. 3) Test generateCode(), executeBacktest(), getJobStatus(), getJobResult(), getFormattedResult() with mock responses.",
            "status": "completed",
            "testStrategy": "Run npm run test to execute API client tests.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Create error handling tests for HTTP status codes",
            "description": "Create error handling tests for HTTP status codes 400, 401, 403, 404, 500 and network errors in tests/unit/api-errors.test.ts.",
            "dependencies": [
              1,
              4
            ],
            "details": "Create tests/unit/api-errors.test.ts: 1) Test 400 Bad Request error handling. 2) Test 401/403 authentication errors. 3) Test 404 Not Found error. 4) Test 500 Internal Server Error. 5) Test network error handling. 6) Test timeout error. Use msw to mock error responses.",
            "status": "completed",
            "testStrategy": "Run npm run test to execute error handling tests.",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": 3,
        "title": "Implement base layout and shared UI components",
        "description": "Implement base layout with responsive two-pane design, navigation, and shared UI components. Set up React Query provider and Zustand store for global state management.",
        "details": "Create src/app/layout.tsx with React Query Provider wrapper, global styles and Tailwind imports. Create src/components/ui/ with Button, Input, Textarea, Select, Card, Alert, LoadingSpinner components. Create src/stores/useBacktestStore.ts with Zustand for generatedCode, jobId, jobStatus, results, uiToggles. Create main page with two-pane layout: Left (config form + actions), Right (code editor + results).",
        "testStrategy": "Verify layout renders correctly on desktop and mobile breakpoints. Test React Query cache invalidation. Test Zustand store state updates.",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "completed",
        "subtasks": [
          {
            "id": 1,
            "title": "Create missing UI components",
            "description": "Create missing UI components in src/components/ui/ directory: Input.tsx (with label, error, disabled props), Textarea.tsx (with rows, placeholder, disabled), Select.tsx (with options array, label, error), Alert.tsx (with variant for info/success/error/warning), LoadingSpinner.tsx (with size prop, centered option). All components should follow existing design patterns from Button.tsx and Card.tsx using Tailwind CSS.",
            "dependencies": [],
            "details": "Create Input.tsx with label, error message, and disabled state support using Tailwind for styling. Create Textarea.tsx with configurable rows and full-width. Create Select.tsx with options array containing value/label pairs. Create Alert.tsx with variant types (info, success, error, warning) and icon support. Create LoadingSpinner.tsx with size variants (sm, md, lg) and optional centering wrapper.",
            "status": "completed",
            "testStrategy": "Test each component renders correctly with different props. Verify Input shows error state, Textarea resizes, Select shows options, Alert displays correct colors per variant, Spinner shows different sizes.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Enhance Zustand store with uiToggles",
            "description": "Enhance useBacktestStore.ts with uiToggles state for managing UI panel visibility and expanded states. Add toggle functions for code editor visibility, results panel, config panel collapse state, and other UI state that needs persistence across components.",
            "dependencies": [
              1
            ],
            "details": "Add uiToggles interface with isCodeEditorOpen, isResultsOpen, isConfigExpanded, selectedTab (code/results). Add setUiToggle functions to update individual toggles. Update reset function to also clear uiToggles. Ensure store follows Zustand best practices with proper typing.",
            "status": "completed",
            "testStrategy": "Verify uiToggles state updates correctly. Test reset clears all UI state. Verify type safety for all toggle functions.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Create Navigation/Header component",
            "description": "Create Navigation/Header component in src/components/layout/Header.tsx with app branding, navigation links, and responsive mobile menu. Include logo, app name 'Backtest Simulation', and optional user actions area.",
            "dependencies": [
              1,
              2
            ],
            "details": "Create Header.tsx with Space Grotesk font logo, app title, and responsive design. Include hamburger menu for mobile. Add basic navigation structure. Export from src/components/layout/index.ts. Use existing CSS variables for theming.",
            "status": "completed",
            "testStrategy": "Verify Header renders with logo and title. Test responsive mobile menu toggle. Verify it integrates with layout.tsx properly.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Improve two-pane responsive layout",
            "description": "Enhance BacktestWorkspace.tsx with proper two-pane responsive layout: Left pane for Configuration Form + Actions (config panel), Right pane for Code Editor + Results. Use grid layout with responsive breakpoints (stack on mobile, side-by-side on md+).",
            "dependencies": [
              1,
              2,
              3
            ],
            "details": "Refactor BacktestWorkspace to use CSS Grid with md:grid-cols-2 for responsive two-pane. Create left pane with Card containing config form placeholder and action buttons. Create right pane with tabbed interface for code editor and results. Add proper spacing and gap utilities. Use uiToggles from store to control pane visibility.",
            "status": "completed",
            "testStrategy": "Verify layout renders side-by-side on desktop (md breakpoint). Verify stacks vertically on mobile. Test tab switching in right pane. Verify action buttons render in left pane.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Export all UI components and verify integration",
            "description": "Update src/components/ui/index.ts to export all UI components including newly created Input, Textarea, Select, Alert, LoadingSpinner. Verify all exports work correctly and components can be imported from @/components/ui.",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "Add export statements for Input, Textarea, Select, Alert, LoadingSpinner in index.ts. Verify all imports work in other components. Test that components can be imported individually or as named exports from @/components/ui.",
            "status": "completed",
            "testStrategy": "Verify all UI components can be imported from @/components/ui. Test no import errors in BacktestWorkspace. Verify no circular dependency issues.",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": 4,
        "title": "Implement config form with validation",
        "description": "Build strategy and parameter input form with all fields specified in FR-2: strategy text, date range, initial capital, benchmarks, contribution settings, fees, dividend reinvestment toggle, web search toggle. Add client-side validation.",
        "details": "Create src/components/backtest/ConfigForm.tsx using React Hook Form + Zod. Schema: strategy (10-10000 chars), start_date (>=2001-01-01), end_date (<=today), initial_capital (>=1000), benchmarks (min 1), contribution.frequency/amount, fees (0-10%), dividend_reinvestment, llm_settings.web_search_enabled. Components: StrategyInput, DateRangePicker, CapitalInput, BenchmarkSelect, ContributionSettings, FeeSettings, Toggles, ValidationSummary.",
        "testStrategy": "Test form validation for all fields. Test character counter. Verify date range validation. Test submission with valid/invalid data.",
        "priority": "high",
        "dependencies": [
          "2",
          "3"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create form UI primitive components",
            "description": "Create reusable form UI primitives in src/components/ui/: Input.tsx (with label, error, helper text), Textarea.tsx (with character counter), Select.tsx (with options prop), and Toggle.tsx (switch component). Export all from ui/index.ts.",
            "dependencies": [
              3
            ],
            "details": "Input component needs type prop, label, placeholder, error message, helper text. Textarea needs rows, maxLength, showCount option. Select needs options array with label/value, placeholder. Toggle needs label and description. All should follow existing Button/Card styling patterns using Tailwind.",
            "status": "done",
            "testStrategy": "Test Input renders with label and displays error. Test Textarea character counter. Test Select options rendering. Test Toggle switch state changes.",
            "parentId": "undefined",
            "updatedAt": "2026-02-14T16:22:03.529Z"
          },
          {
            "id": 2,
            "title": "Create Zod validation schema",
            "description": "Create Zod validation schema in src/lib/validations/backtest.ts defining all form field validations matching FR-2 requirements: strategy (10-10000 chars), start_date (>=2001-01-01), end_date (<=today), initial_capital (>=1000), benchmarks (min 1), contribution.frequency/amount, fees (0-10%), dividend_reinvestment, llm_settings.web_search_enabled.",
            "dependencies": [
              3
            ],
            "details": "Use zod for schema definition. Create separate schemas for nested objects (contribution, fees, llm_settings). Use z.coerce.date() for date fields. Include custom error messages. Export type inferred from schema.",
            "status": "done",
            "testStrategy": "Test valid data passes. Test strategy min/max length validation. Test date range validation (start >= 2001, end <= today). Test capital >= 1000. Test benchmarks min 1. Test fees 0-10%.",
            "parentId": "undefined",
            "updatedAt": "2026-02-14T16:22:05.048Z"
          },
          {
            "id": 3,
            "title": "Create StrategyInput and DateRangePicker components",
            "description": "Create StrategyInput and DateRangePicker components in src/components/backtest/: StrategyInput.tsx using Textarea with character counter, DateRangePicker.tsx with two date inputs and cross-field validation.",
            "dependencies": [
              3
            ],
            "details": "StrategyInput: Use Textarea, show character count (X/10000), limit to 10000 chars. DateRangePicker: Two date inputs (start, end), validate start >= 2001-01-01, end <= today, start <= end. Use native date inputs or simple custom implementation.",
            "status": "done",
            "testStrategy": "Test StrategyInput character counter updates. Test StrategyInput shows error for <10 or >10000 chars. Test DateRangePicker start/end validation. Test cross-field validation (start <= end).",
            "parentId": "undefined",
            "updatedAt": "2026-02-14T16:22:06.564Z"
          },
          {
            "id": 4,
            "title": "Create CapitalInput, BenchmarkSelect, ContributionSettings components",
            "description": "Create CapitalInput, BenchmarkSelect, and ContributionSettings components in src/components/backtest/. CapitalInput: number input with currency formatting. BenchmarkSelect: multi-select for benchmarks (KOSPI, KOSDAQ, etc). ContributionSettings: frequency dropdown + amount input.",
            "dependencies": [
              3
            ],
            "details": "CapitalInput: Input with type=number, min=1000, show formatted value. BenchmarkSelect: Multi-select with checkboxes or tags, min 1 required, show selected count. ContributionSettings: Select for frequency (monthly, quarterly, semiannual, annual), Input for amount (>=0).",
            "status": "done",
            "testStrategy": "Test CapitalInput validates >= 1000. Test BenchmarkSelect requires min 1 selection. Test ContributionSettings frequency/amount validation.",
            "parentId": "undefined",
            "updatedAt": "2026-02-14T16:22:08.072Z"
          },
          {
            "id": 5,
            "title": "Create Toggles, ValidationSummary and integrate ConfigForm",
            "description": "Create Toggles component (dividend_reinvestment, web_search), ValidationSummary component, and integrate all fields into ConfigForm.tsx using React Hook Form + zod-resolver.",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "Toggles: Two toggle switches for dividend_reinvestment and llm_settings.web_search_enabled. ValidationSummary: List of all validation errors at top of form. ConfigForm: Use useForm hook, integrate all components, handle submit, show loading state. Wire up form to store actions.",
            "status": "done",
            "testStrategy": "Test form validation on submit. Test ValidationSummary shows all errors. Test toggles persist state. Test form submits valid data. Test character counter on strategy field.",
            "parentId": "undefined",
            "updatedAt": "2026-02-14T16:22:09.572Z"
          }
        ],
        "updatedAt": "2026-02-14T16:22:09.572Z"
      },
      {
        "id": 5,
        "title": "Implement generate code flow with code editor",
        "description": "Implement Generate Code flow calling POST /api/v1/backtest/generate. Integrate Monaco Editor with Python syntax highlighting. Show model info, strategy summary, generation duration, detected tickers. Handle loading state and timeout (30s).",
        "details": "Create src/components/backtest/CodeEditorPanel.tsx with Monaco Editor (Python language, read-only by default, editable on user modification). Create src/hooks/useGenerateCode.ts with useMutation for POST /api/v1/backtest/generate, handle loading/success/error states, timeout after 30s. Display model info badge, strategy summary, generation time, tickers found. Disable Execute button if no generated code exists.",
        "testStrategy": "Test generate with valid/invalid strategy. Test timeout handling. Test error display. Verify code editor populates correctly.",
        "priority": "high",
        "dependencies": [
          "2",
          "3",
          "4"
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Add generation metadata to Zustand store",
            "description": "Add GenerationMetadata type to the store state interface to track model_info, strategy_summary, tickers_found, and generation_time_seconds alongside generated code. Update useBacktestStore with new state fields and setter actions.",
            "dependencies": [],
            "details": "The current Zustand store only tracks generatedCode, jobId, jobStatus, results, and uiToggles. We need to extend it to also store the metadata returned from the generate API: model_info (provider, model_id), strategy_summary, tickers_found array, and generation_time_seconds. Add setGenerationMetadata action to update these fields.",
            "status": "done",
            "testStrategy": "Verify store correctly updates all new metadata fields. Test that setGenerationMetadata properly replaces previous values. Verify reset() clears all new fields.",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Create useGenerateCode hook with mutation and timeout",
            "description": "Create src/hooks/useGenerateCode.ts with React Query's useMutation hook calling generateCode from the API client. Implement 30-second timeout handling using AbortController. Handle loading state via isPending, success state updating the store with code and metadata, and error state. Import and use setGeneratedCode and setGenerationMetadata from the store to update state on success.",
            "dependencies": [
              1
            ],
            "details": "Create the useGenerateCode hook that wraps generateCode API call with useMutation. Add AbortController for 30-second timeout. Handle isPending for loading, isError for errors, and onSuccess to update Zustand store with generated code and metadata. Store needs setGeneratedCode and setGenerationMetadata actions.",
            "status": "done",
            "testStrategy": "Test mutation with valid BacktestRequest succeeds and updates store. Test timeout after 30s triggers timeout error. Test network error displays correctly. Verify isLoading, isError, isSuccess states work as expected.",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "Create CodeEditorPanel component with Monaco Editor",
            "description": "Create src/components/backtest/CodeEditorPanel.tsx using @monaco-editor/react. Configure with language: 'python', readOnly by default. Add internal state for editMode toggle - when user clicks edit button, set readOnly to false. Accept code prop and onChange callback. Include loading state with LoadingSpinner when code is being generated. Style with dark theme matching project aesthetics.",
            "dependencies": [
              2
            ],
            "details": "Use @monaco-editor/react to create CodeEditorPanel component. Configure Monaco with language: 'python', readOnly: true by default, and dark theme. Add editMode state that toggles readOnly when user clicks edit button. Accept code string prop and onChange callback for code modifications. Show LoadingSpinner from UI components when isLoading is true.",
            "status": "done",
            "testStrategy": "Test Monaco Editor renders with Python syntax highlighting. Test readOnly mode prevents editing. Test edit mode allows code modification. Test onChange callback fires when code is edited. Test loading spinner displays during generation.",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "Create GenerationInfo display component",
            "description": "Create src/components/backtest/GenerationInfo.tsx to display metadata returned from generation: ModelInfo badge showing provider/model_id, strategy_summary text, generation_time_seconds with formatting, and tickers_found as pills/tags. Accept generation metadata as props and handle empty/null states gracefully.",
            "dependencies": [
              1,
              2
            ],
            "details": "Create GenerationInfo component that displays ModelInfo (provider + model_id as badge), strategy_summary (text paragraph), generation_time_seconds (formatted duration), and tickers_found (array rendered as styled pill/tag components). Handle null/undefined metadata gracefully with empty state. Use existing UI components like Alert or custom styling for the badges and pills.",
            "status": "done",
            "testStrategy": "Test ModelInfo badge displays provider and model_id correctly. Test strategy_summary renders text properly. Test generation_time displays in human-readable format. Test tickers render as styled pills. Test empty/null states show appropriate placeholders.",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "Integrate all components into BacktestWorkspace",
            "description": "Update BacktestWorkspace.tsx to integrate the new components: Add Generate Code button that triggers useGenerateCode mutation, pass generatedCode from store to CodeEditorPanel, add GenerationInfo component below code editor, and add Execute button that is disabled when no generated code exists in store. Wire up all callbacks and state connections properly.",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "Modify BacktestWorkspace to use useGenerateCode hook. Replace placeholder code section with CodeEditorPanel component passing generatedCode from store. Add GenerationInfo component to show metadata. Update Generate Code button to call mutate with form data. Add Execute button that is disabled={!generatedCode}. Handle loading state on buttons. Show error state from mutation.",
            "status": "done",
            "testStrategy": "Test Generate button triggers code generation. Test CodeEditorPanel displays generated code. Test GenerationInfo shows metadata after successful generation. Test Execute button is disabled when no code exists. Test loading state shows during generation. Test error state displays on failure.",
            "parentId": "undefined"
          }
        ]
      },
      {
        "id": 6,
        "title": "Implement execute/polling flow with status display",
        "description": "Implement Execute Backtest flow calling POST /api/v1/backtest/execute with async_mode=true. Implement polling mechanism calling GET /api/v1/backtest/status/{job_id} every 2 seconds. Handle pending/running/completed/failed states.",
        "details": "Create src/hooks/useExecuteBacktest.ts with useMutation for POST /api/v1/backtest/execute. Create src/hooks/useJobPolling.ts with useQuery refetchInterval: 2000ms, stop polling on terminal states. UI States: Submitting, Pending (show job_id), Running (show elapsed), Completed, Failed (show error + logs). Create StatusBanner component. Handle network errors with retry, 404 errors, long-running job elapsed counter.",
        "testStrategy": "Test execute flow with mock API. Test polling stops on completion/failure. Test network error handling. Verify job_id displays correctly.",
        "priority": "high",
        "dependencies": [
          "3",
          "5"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Create useExecuteBacktest hook with useMutation",
            "description": "Create src/hooks/useExecuteBacktest.ts with useMutation for POST /api/v1/backtest/execute. Use executeBacktest API from lib/api/client.ts. Pass async_mode=true in request. Update Zustand store with jobId and jobStatus on success. Handle loading state (isPending), error state, and success callback.",
            "dependencies": [],
            "details": "Create useExecuteBacktest hook that calls executeBacktest(payload: ExecuteBacktestRequest) from API client. Set async_mode: true in the request payload. On success, call setJobState(jobId, status) from useBacktestStore. Export mutate function, isPending, isError, error states. Use try/catch for error handling.",
            "status": "pending",
            "testStrategy": "Test execute mutation with mock API response. Verify isPending state during submission. Test error handling with mock API failure. Verify jobId and jobStatus are set in store on success."
          },
          {
            "id": 2,
            "title": "Create useJobPolling hook with useQuery",
            "description": "Create src/hooks/useJobPolling.ts with useQuery for polling GET /api/v1/backtest/status/{job_id} every 2 seconds. Stop polling on terminal states (completed, failed, cancelled, timeout). Use getJobStatus from lib/api/client.ts.",
            "dependencies": [
              1
            ],
            "details": "Create useJobPolling hook that accepts jobId. Use useQuery with refetchInterval: 2000ms. Define queryKey: ['jobStatus', jobId]. Implement queryFn: getJobStatus(jobId). Use enabled: !!jobId. Implement getJobResult for terminal states to fetch results. Return status, data, isLoading, error. Handle network errors with retry (3 attempts).",
            "status": "pending",
            "testStrategy": "Test polling stops when job reaches terminal state. Verify polling interval is 2 seconds. Test 404 error handling. Verify retry logic works correctly. Test with mock job status progression."
          },
          {
            "id": 3,
            "title": "Create StatusBanner component for job status display",
            "description": "Create src/components/backtest/StatusBanner.tsx component to display job status. Support states: Submitting, Pending (show job_id), Running (show elapsed time), Completed, Failed (show error + logs). Use Alert and Card components from UI library.",
            "dependencies": [
              1,
              2
            ],
            "details": "Create StatusBanner component with props: status (JobStatus), jobId, error?, logs?, startTime?. Use LoadingSpinner for non-terminal states. Display job_id in Pending state. Calculate and display elapsed time in Running state (use setInterval). Show error message and logs in Failed state. Use color coding: blue=pending, yellow=running, green=completed, red=failed.",
            "status": "pending",
            "testStrategy": "Test each status display. Verify elapsed time counter works. Test error and logs display. Verify loading spinner shows correctly."
          },
          {
            "id": 4,
            "title": "Integrate hooks into BacktestWorkspace",
            "description": "Update BacktestWorkspace.tsx to wire up Execute button. Import useExecuteBacktest and useJobPolling hooks. Connect StatusBanner to display job status. Handle button disabled state (disable if no generated code).",
            "dependencies": [
              1,
              2,
              3
            ],
            "details": "In BacktestWorkspace, import useExecuteBacktest and useJobPolling. Add Execute button onClick handler that calls executeMutation with generated code. Use jobId from store for useJobPolling. Display StatusBanner when jobId exists. Show results when status is completed.",
            "status": "pending",
            "testStrategy": "Test Execute button disabled state. Verify StatusBanner displays correctly. Test full execute flow with mock API. Verify polling starts after job submission."
          },
          {
            "id": 5,
            "title": "Add error handling and elapsed time counter",
            "description": "Add network error handling with retry, 404 error handling, and elapsed time counter. Implement retry logic (3 attempts with exponential backoff) for network errors. Handle 404 by showing job not found message.",
            "dependencies": [
              1,
              2
            ],
            "details": "In useJobPolling, configure retry: 3 with retryDelay: exponential backoff. Handle 404 specifically with isJobNotFound state. Add elapsed time tracking using startTime timestamp in store. Display elapsed time in HH:MM:SS format in StatusBanner.",
            "status": "pending",
            "testStrategy": "Test retry behavior with mock network failures. Test 404 handling. Verify elapsed time displays correctly for long-running jobs."
          }
        ]
      },
      {
        "id": 7,
        "title": "Implement results visualization components",
        "description": "Implement results visualization: primary metrics (total_return, cagr, max_drawdown with benchmark delta), secondary metrics (sharpe, sortino, calmar), equity curve chart with log scale toggle, drawdown chart, monthly returns heatmap, trade table.",
        "details": "Create src/components/results/MetricsCards.tsx with primary/secondary metrics. Create EquityChart.tsx with Recharts LineChart (strategy + benchmark lines, log scale toggle). Create DrawdownChart.tsx with AreaChart. Create MonthlyHeatmap.tsx with custom grid. Create TradeTable.tsx with collapsible panel, sortable columns, action/profit formatting. All handle loading/empty states.",
        "testStrategy": "Test metrics display with mock data. Test equity chart with/without benchmark. Test log scale toggle. Test heatmap color coding. Test trade table sorting.",
        "priority": "high",
        "dependencies": [
          "2",
          "3",
          "6"
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Create MetricsCards component for primary/secondary metrics display",
            "description": "Create src/components/results/MetricsCards.tsx to display primary metrics (total_return, cagr, max_drawdown with benchmark delta) and secondary metrics (sharpe, sortino, calmar). Use Card component for layout, format percentages/currency values, show loading spinner when metrics are not available, display empty state with appropriate message when results are null.",
            "dependencies": [],
            "details": "Create MetricsCards component that accepts PerformanceMetrics and benchmark data as props. Display primary metrics in a prominent grid showing total return, CAGR, and max drawdown with benchmark comparison (delta). Show secondary metrics (Sharpe ratio, Sortino ratio, Calmar ratio) in a separate section. Handle loading state with LoadingSpinner, and empty state with Alert when metrics are unavailable. Use formatPercentage and formatNumber utility functions for value display.",
            "status": "pending",
            "testStrategy": "Test with mock PerformanceMetrics data. Verify primary/secondary metric display. Test loading state rendering. Test empty state handling. Verify benchmark delta calculation and display."
          },
          {
            "id": 2,
            "title": "Create EquityChart component with Recharts LineChart and log scale toggle",
            "description": "Create src/components/results/EquityChart.tsx with Recharts LineChart displaying strategy and benchmark equity curves, include log scale toggle using Toggle component, handle loading and empty states appropriately.",
            "dependencies": [],
            "details": "Create EquityChart component using Recharts LineChart that accepts equity_curve data from BacktestResultResponse. Display strategy line in primary color (brand-500) and benchmark line in secondary color (slate-400). Implement log scale toggle that switches between linear and logarithmic y-axis using Recharts YAxis type='logDomain'. Handle loading state with LoadingSpinner, and empty state with Alert when equity_curve data is null or empty. Add proper tooltips showing date and value. Use existing Toggle component for log scale switch.",
            "status": "pending",
            "testStrategy": "Test with mock EquityCurveData including both strategy and benchmark. Test log scale toggle functionality. Verify chart renders with single line (no benchmark). Test loading and empty states. Verify tooltip displays correct values."
          },
          {
            "id": 3,
            "title": "Create DrawdownChart component with Recharts AreaChart",
            "description": "Create src/components/results/DrawdownChart.tsx with Recharts AreaChart to visualize drawdown data over time, handle loading and empty states.",
            "dependencies": [],
            "details": "Create DrawdownChart component using Recharts AreaChart that accepts drawdown data from BacktestResultResponse. Display drawdown as negative percentage values with gradient fill. Configure XAxis for dates and YAxis for percentage values. Add tooltip showing date and drawdown percentage. Handle loading state with LoadingSpinner, and empty state with Alert when drawdown data is unavailable. Use area gradient from brand-500 to transparent for visual effect.",
            "status": "pending",
            "testStrategy": "Test with mock DrawdownData. Verify area chart renders correctly with gradient. Test loading state rendering. Test empty state handling. Verify tooltip shows correct negative percentage values."
          },
          {
            "id": 4,
            "title": "Create MonthlyHeatmap component with custom grid for monthly returns",
            "description": "Create src/components/results/MonthlyHeatmap.tsx with custom grid layout to display monthly returns heatmap, implement color coding for positive/negative returns, handle loading and empty states.",
            "dependencies": [],
            "details": "Create MonthlyHeatmap component that accepts monthly_heatmap data from BacktestResultResponse. Render custom grid with years as rows and months as columns. Implement color coding: green shades for positive returns, red shades for negative returns, gray for null values. Display percentage values in each cell with proper formatting. Handle loading state with LoadingSpinner, and empty state with Alert when monthly_heatmap data is unavailable. Use CSS grid or flexbox for layout.",
            "status": "pending",
            "testStrategy": "Test with mock MonthlyHeatmapData including multiple years. Verify color coding matches return values. Test handling of null values. Test loading state rendering. Test empty state handling. Verify grid layout is responsive."
          },
          {
            "id": 5,
            "title": "Create TradeTable component with sortable columns and collapsible panel",
            "description": "Create src/components/results/TradeTable.tsx with collapsible panel, sortable columns, and action/profit formatting, display trade details including entry/exit dates, ticker, action (buy/sell), profit/loss, handle loading and empty states.",
            "dependencies": [],
            "details": "Create TradeTable component that accepts trades array from BacktestResultResponse. Implement collapsible panel using existing UI patterns - show header with trade count and expand/collapse toggle. Implement sortable columns for date, ticker, action, profit. Format action as 'Buy'/'Sell' badges with color coding (green for buy, red for sell). Format profit/loss with color coding (green for profit, red for loss) and percentage values. Handle loading state with LoadingSpinner, and empty state with Alert when trades array is empty or null. Use standard HTML table with proper semantic markup.",
            "status": "pending",
            "testStrategy": "Test with mock trades array. Verify sort functionality on each column. Test collapsible panel expand/collapse. Test action badge coloring. Test profit/loss formatting and coloring. Test loading state rendering. Test empty state handling."
          }
        ]
      },
      {
        "id": 8,
        "title": "Implement CSV export functionality",
        "description": "Implement CSV export for equity curve, drawdown, monthly returns, metrics, trades. Buttons disabled until results available.",
        "details": "Create src/lib/export/csv.ts with generators: generateEquityCSV, generateDrawdownCSV, generateMonthlyCSV, generateMetricsCSV, generateTradesCSV. Create src/components/results/ExportButtons.tsx with 5 download buttons, disabled until results available. Filename format: backtest_{type}_{job_id}_{date}.csv. Handle special characters, add BOM for Excel.",
        "testStrategy": "Test CSV generation with mock data. Test file download in browser. Verify CSV opens in Excel. Test disabled state.",
        "priority": "medium",
        "dependencies": [
          "7"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": 9,
        "title": "Configure CORS and production routing",
        "description": "Configure CORS for production Next.js domain in FastAPI. Update root path redirect to new frontend. Set up production deployment topology.",
        "details": "Backend (backend/main.py): Update CORS middleware with ALLOWED_ORIGINS env var, allow specific frontend origin in production. Update root redirect from /dashboard/ to new frontend URL with feature flag. Keep /dashboard for rollback. Nginx: proxy /api/* to FastAPI, serve Next.js. Frontend: update NEXT_PUBLIC_API_BASE_URL, configure standalone output in next.config.js. docker-compose.prod.yml: Next.js + FastAPI + Nginx.",
        "testStrategy": "Test CORS with specific origin. Test root redirect. Verify /dashboard works for rollback. Test production build.",
        "priority": "high",
        "dependencies": [
          "1"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": 10,
        "title": "Setup tests, CI, and deployment configuration",
        "description": "Implement unit tests, integration tests with mocked API, E2E tests for critical path. Add CI pipeline with linting, type checking, test execution.",
        "details": "Create tests/unit/: validation.test.ts, api-mappers.test.ts, csv-export.test.ts. Create tests/integration/: generate-flow.test.tsx, execute-flow.test.tsx, results-display.test.tsx. Create tests/e2e/: critical-path.test.ts with full flow (input->generate->execute->result->export). CI Pipeline: eslint, tsc --noEmit, vitest, next build. Add regression checks: compare metrics with Dash output, snapshot tests for charts.",
        "testStrategy": "Run npm run test. Verify E2E passes in CI. Check test coverage. Verify no TypeScript errors.",
        "priority": "medium",
        "dependencies": [
          "4",
          "5",
          "6",
          "7",
          "8"
        ],
        "status": "pending",
        "subtasks": []
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-02-14T16:22:09.573Z",
      "taskCount": 10,
      "completedCount": 1,
      "tags": [
        "master"
      ],
      "created": "2026-02-15T01:37:05.909Z",
      "description": "Tasks for master context"
    }
  }
}